<div class="col-md-8 mx-auto">
  <div class="row">
    <div class="col-md-12 mx-auto my-5">
      <div class="card">
        <div class="card-body">
          <h3 class="text-center mt-2">{{ colegioSvc.nombreColegio }}</h3>
        </div>
      </div>
    </div>
  </div>
  <div
    class="card mb-5"
    *ngIf="documentos.length > 0; else sinHorariosGenerados"
  >
    <div class="card-body text-center">
      <label class="mt-2">Fecha y Hora generacion</label>
      <select
        class="form-select"
        (input)="cambiarDocumento()"
        (ngModel)="(documentoActual)"
      >
        <option *ngFor="let documento of documentos" value="{{ documento }}">
          {{ documento }}
        </option>
      </select>

      <ng-container *ngIf="cursoActual != ''">
        <label class="mt-2">Cursos</label>
        <select class="form-select" (ngModel)="(cursoActual)">
          <option
            *ngFor="let curso of colegioSvc.cursoArray"
            value="{{ curso.nombre }}"
          >
            {{ curso.nombre }}
          </option>
        </select>

        <table class="table text-center mt-2">
          <thead>
            <tr class="table-light">
              <th class="rounded-start" scope="col">Horarios</th>
              <th scope="col"></th>
              <th scope="col">Lunes</th>
              <th scope="col">Martes</th>
              <th scope="col">Miercoles</th>
              <th scope="col">Jueves</th>
              <th class="rounded-end" scope="col">Viernes</th>
            </tr>
          </thead>
          <tbody>
            <!-- MAÃ‘ANA  -->
            <tr *ngIf="colegioSvc.turnoArray[0].habilitado">
              <td colspan="7" class="table-active">INICIO ACTIVIDADES</td>
            </tr>
            <ng-container *ngIf="colegioSvc.turnoArray[0].habilitado">
              <tr
                *ngFor="
                  let modulo of colegioSvc.turnoArray[0].modulos;
                  let m = index
                "
                class="bg-white"
              >
                <td colspan="2" class="text-black">
                  {{ modulo.inicio }} - {{ modulo.final }}
                </td>
                <td
                  *ngFor="let dia of colegioSvc.dias; let d = index"
                  colspan="1"
                  class="text-black"
                >
                  <li
                    *ngIf="
                      horariosHechos[this.cursoActual][dia]['manana'][
                        modulo.inicio
                      ] != ''
                    "
                    class="list-group-item list-group-item-action"
                    data-bs-toggle="collapse"
                    [attr.data-bs-target]="'#collapseExampleManana' + d + m"
                    aria-expanded="false"
                  >
                    <div>
                      {{
                        horariosHechos[this.cursoActual][dia]["manana"][
                          modulo.inicio
                        ]
                      }}
                      <div
                        class="collapse"
                        [attr.id]="'collapseExampleManana' + d + m"
                      >
                        <li class="list-group-item">
                          <span>{{
                            horariosAulasHechos[this.cursoActual][dia][
                              "manana"
                            ][modulo.inicio]
                          }}</span>
                        </li>
                        <li class="list-group-item">
                          <span>{{
                            materiasProfesoresHechos[
                              horariosHechos[this.cursoActual][dia]["manana"][
                                modulo.inicio
                              ] +
                                "-" +
                                this.cursoActual
                            ]
                          }}</span>
                        </li>
                      </div>
                    </div>
                  </li>
                </td>
              </tr>
            </ng-container>

            <!-- TARDE  -->
            <tr *ngIf="colegioSvc.turnoArray[1].habilitado">
              <td colspan="7" class="table-active">INICIO ACTIVIDADES</td>
            </tr>
            <ng-container *ngIf="colegioSvc.turnoArray[1].habilitado">
              <tr
                *ngFor="
                  let modulo of colegioSvc.turnoArray[1].modulos;
                  let m = index
                "
                class="bg-white"
              >
                <td colspan="2" class="text-black">
                  {{ modulo.inicio }} - {{ modulo.final }}
                </td>
                <td
                  *ngFor="let dia of colegioSvc.dias; let d = index"
                  colspan="1"
                  class="text-black"
                >
                  <li
                    *ngIf="
                      horariosHechos[this.cursoActual][dia]['tarde'][
                        modulo.inicio
                      ] != ''
                    "
                    class="list-group-item list-group-item-action"
                    data-bs-toggle="collapse"
                    [attr.data-bs-target]="'#collapseExampleTarde' + d + m"
                    aria-expanded="false"
                  >
                    <div>
                      {{
                        horariosHechos[this.cursoActual][dia]["tarde"][
                          modulo.inicio
                        ]
                      }}
                      <div
                        class="collapse"
                        [attr.id]="'collapseExampleTarde' + d + m"
                      >
                        <li class="list-group-item">
                          <span>{{
                            horariosAulasHechos[this.cursoActual][dia]["tarde"][
                              modulo.inicio
                            ]
                          }}</span>
                        </li>
                        <li class="list-group-item">
                          <span>{{
                            materiasProfesoresHechos[
                              horariosHechos[this.cursoActual][dia]["tarde"][
                                modulo.inicio
                              ] +
                                "-" +
                                this.cursoActual
                            ]
                          }}</span>
                        </li>
                      </div>
                    </div>
                  </li>
                </td>
              </tr>
            </ng-container>

            <!-- NOCHE  -->
            <tr *ngIf="colegioSvc.turnoArray[2].habilitado">
              <td colspan="7" class="table-active">INICIO ACTIVIDADES</td>
            </tr>
            <ng-container *ngIf="colegioSvc.turnoArray[2].habilitado">
              <tr
                *ngFor="
                  let modulo of colegioSvc.turnoArray[2].modulos;
                  let m = index
                "
                class="bg-white"
              >
                <td colspan="2" class="text-black">
                  {{ modulo.inicio }} - {{ modulo.final }}
                </td>
                <td
                  *ngFor="let dia of colegioSvc.dias; let d = index"
                  colspan="1"
                  class="text-black"
                >
                  <li
                    *ngIf="
                      horariosHechos[this.cursoActual][dia]['noche'][
                        modulo.inicio
                      ] != ''
                    "
                    class="list-group-item list-group-item-action"
                    data-bs-toggle="collapse"
                    [attr.data-bs-target]="'#collapseExampleNoche' + d + m"
                    aria-expanded="false"
                  >
                    <div>
                      {{
                        horariosHechos[this.cursoActual][dia]["noche"][
                          modulo.inicio
                        ]
                      }}
                      <div
                        class="collapse"
                        [attr.id]="'collapseExampleNoche' + d + m"
                      >
                        <li class="list-group-item">
                          <span>{{
                            horariosAulasHechos[this.cursoActual][dia]["noche"][
                              modulo.inicio
                            ]
                          }}</span>
                        </li>
                        <li class="list-group-item">
                          <span>{{
                            materiasProfesoresHechos[
                              horariosHechos[this.cursoActual][dia]["noche"][
                                modulo.inicio
                              ] +
                                "-" +
                                this.cursoActual
                            ]
                          }}</span>
                        </li>
                      </div>
                    </div>
                  </li>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>

        <button class="btn btn-primary my-2" (click)="exportAsExcelFile()">
          Descargar Horarios
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            class="bi bi-download ms-1"
            viewBox="0 0 16 16"
          >
            <path
              d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"
            />
            <path
              d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"
            />
          </svg>
        </button>
      </ng-container>
    </div>
  </div>
  <ng-template #sinHorariosGenerados>
    <div class="card mb-5">
      <div class="card-body">
        <h3 class="text-center my-2">Aun no tienes colegios generados</h3>
      </div>
    </div>
  </ng-template>
</div>
